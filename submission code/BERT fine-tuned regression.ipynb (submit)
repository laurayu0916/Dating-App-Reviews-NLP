{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"BERT fine-tuned regression.ipynb (submit)","provenance":[{"file_id":"1o40eA2tJAOfroAYc8v7dO08OXjo6cwsF","timestamp":1652403724653}],"machine_shape":"hm","collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"c73689dabc154460b62ca969bd966356":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_355b8fc89a694b4594cb083c8d5da728","IPY_MODEL_669496d664864517a8d54cce73d66ae9","IPY_MODEL_04eb7850d1dd40a089d61206c2376809"],"layout":"IPY_MODEL_a2189a76c0694812a3ad5eaa8878a041"}},"355b8fc89a694b4594cb083c8d5da728":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_448a122015a34b46a65888ce295f3680","placeholder":"​","style":"IPY_MODEL_7e4fca1b2be545309f25e3d987ac0f14","value":"Downloading: 100%"}},"669496d664864517a8d54cce73d66ae9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_156d8cd6f3e64b22be5a465d976baaba","max":28,"min":0,"orientation":"horizontal","style":"IPY_MODEL_06392519b2b3454785f929b20b1e09e4","value":28}},"04eb7850d1dd40a089d61206c2376809":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8cf4e93a74e842bda7ad2caac32dea08","placeholder":"​","style":"IPY_MODEL_4310e9468fd64f3ab10ba47fcac6e896","value":" 28.0/28.0 [00:00&lt;00:00, 850B/s]"}},"a2189a76c0694812a3ad5eaa8878a041":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"448a122015a34b46a65888ce295f3680":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7e4fca1b2be545309f25e3d987ac0f14":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"156d8cd6f3e64b22be5a465d976baaba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"06392519b2b3454785f929b20b1e09e4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8cf4e93a74e842bda7ad2caac32dea08":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4310e9468fd64f3ab10ba47fcac6e896":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"650d91dd4ddc41988dabbca35e023d69":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dabef8c995304c0abcbdf4c8140285a6","IPY_MODEL_839399320a9f46a1b3c3d2a6af29ad4e","IPY_MODEL_b4b4d6a602234da0845ff348c55abb85"],"layout":"IPY_MODEL_671e7155eb00400ab1dd5bdfdbcb7e7e"}},"dabef8c995304c0abcbdf4c8140285a6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1e0bfebfd62340fdb7bd8941e3db62b1","placeholder":"​","style":"IPY_MODEL_1d427807d5544e91a1bd8b0dd59f12f7","value":"Downloading: 100%"}},"839399320a9f46a1b3c3d2a6af29ad4e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f07cba2886e9425c9c5b216cf0d2852e","max":483,"min":0,"orientation":"horizontal","style":"IPY_MODEL_baa47ec25b054f68b0a6c4e02f9dd944","value":483}},"b4b4d6a602234da0845ff348c55abb85":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_62b1ae2f8c2f4209be0793f4de4d917f","placeholder":"​","style":"IPY_MODEL_75f5a6e9ea4748f38b6d38103644e6b5","value":" 483/483 [00:00&lt;00:00, 20.3kB/s]"}},"671e7155eb00400ab1dd5bdfdbcb7e7e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e0bfebfd62340fdb7bd8941e3db62b1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1d427807d5544e91a1bd8b0dd59f12f7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f07cba2886e9425c9c5b216cf0d2852e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"baa47ec25b054f68b0a6c4e02f9dd944":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"62b1ae2f8c2f4209be0793f4de4d917f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"75f5a6e9ea4748f38b6d38103644e6b5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b08e48ffeeb24352be218a5c9a577c12":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_126d66791d1a474299a1967bda8975cb","IPY_MODEL_33507e5d29fe4ec1abedef2656250c75","IPY_MODEL_772802b78a2e4516a07c2ba676aea659"],"layout":"IPY_MODEL_a00562d156be49bebe5b2c0875274968"}},"126d66791d1a474299a1967bda8975cb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_95566268cb67462494efdae87d1749c5","placeholder":"​","style":"IPY_MODEL_eb9c36ebdc5e4464be3bd5b264e621b8","value":"Downloading: 100%"}},"33507e5d29fe4ec1abedef2656250c75":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6321c11e348c4ed48c82f32d1fbe81ad","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6991293b7d974856895d3b8e58e381e7","value":231508}},"772802b78a2e4516a07c2ba676aea659":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2dc6d2855ec248ba82fa590633698a21","placeholder":"​","style":"IPY_MODEL_2a08cc18b90c41868003bb972528c16c","value":" 226k/226k [00:00&lt;00:00, 267kB/s]"}},"a00562d156be49bebe5b2c0875274968":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"95566268cb67462494efdae87d1749c5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eb9c36ebdc5e4464be3bd5b264e621b8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6321c11e348c4ed48c82f32d1fbe81ad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6991293b7d974856895d3b8e58e381e7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2dc6d2855ec248ba82fa590633698a21":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2a08cc18b90c41868003bb972528c16c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bd3f720d0c094206a33eaa23d072c22a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dbbcaf896c7c47518904a781ba110231","IPY_MODEL_1104e88d72c94205ad934ee19beb1983","IPY_MODEL_c905516344274078b3125d24731e3ff5"],"layout":"IPY_MODEL_18693f11ec414fa1801966eb74ea01aa"}},"dbbcaf896c7c47518904a781ba110231":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0df20fa207b04b6fb6cb9e7c37b5b761","placeholder":"​","style":"IPY_MODEL_05037e8a3c2b44c39a74b4a0c47b784b","value":"Downloading: 100%"}},"1104e88d72c94205ad934ee19beb1983":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_50c4340771f844419f7abe2f3f4e1409","max":466062,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ea7f722d532a48da98f3ad46e646130c","value":466062}},"c905516344274078b3125d24731e3ff5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_208068876df840f38271cf702a82483a","placeholder":"​","style":"IPY_MODEL_5afa9b1632794dc99241a1efc1282bc1","value":" 455k/455k [00:01&lt;00:00, 490kB/s]"}},"18693f11ec414fa1801966eb74ea01aa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0df20fa207b04b6fb6cb9e7c37b5b761":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"05037e8a3c2b44c39a74b4a0c47b784b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"50c4340771f844419f7abe2f3f4e1409":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ea7f722d532a48da98f3ad46e646130c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"208068876df840f38271cf702a82483a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5afa9b1632794dc99241a1efc1282bc1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5895e371bc374e56ac9387aa6d77c4fc":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ff0e9c9692414dccb61693e3b37dbc2c","IPY_MODEL_31f7c023f7844813a3d312f80ae8a654","IPY_MODEL_e5d33f8d5b624b6c974cd47c24e861e6"],"layout":"IPY_MODEL_2927a394a46c42998cb3646d4414f336"}},"ff0e9c9692414dccb61693e3b37dbc2c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6f013c0fe5ac4eb4b248f7660ac285a3","placeholder":"​","style":"IPY_MODEL_9832bc9fd7d744d48b2d3059a3fa6750","value":"Downloading: 100%"}},"31f7c023f7844813a3d312f80ae8a654":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_efa0f16b89d44abca8441c21edd3f7e2","max":267967963,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ba13f81bb0e644a8bb660f56e74b0c07","value":267967963}},"e5d33f8d5b624b6c974cd47c24e861e6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b75b6b4eeead41caaaa87e8c7146034e","placeholder":"​","style":"IPY_MODEL_c795c44d63774ce68f0a80cf48814226","value":" 256M/256M [00:04&lt;00:00, 64.3MB/s]"}},"2927a394a46c42998cb3646d4414f336":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6f013c0fe5ac4eb4b248f7660ac285a3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9832bc9fd7d744d48b2d3059a3fa6750":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"efa0f16b89d44abca8441c21edd3f7e2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ba13f81bb0e644a8bb660f56e74b0c07":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b75b6b4eeead41caaaa87e8c7146034e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c795c44d63774ce68f0a80cf48814226":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"40b9babba79e4775a7bfbc85a8f8feca":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f851b46ca63149a2a8ce9d9c843b89ac","IPY_MODEL_f63a283e753c4ec1a44e7a225387caea","IPY_MODEL_3dc05ceb1b2749a886bb6c54821ceaf2"],"layout":"IPY_MODEL_3b888c2a16c3492e91710bcca381c211"}},"f851b46ca63149a2a8ce9d9c843b89ac":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_db4a2992342540059f2f82f8bc154873","placeholder":"​","style":"IPY_MODEL_916685ec38bc4c4490e462d25710ad2d","value":"100%"}},"f63a283e753c4ec1a44e7a225387caea":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_05146061c9494df2bd747c5af73aeb08","max":63114,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f9266defd60b4d24a685654b5aac98a8","value":63114}},"3dc05ceb1b2749a886bb6c54821ceaf2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fef9c0daa7494a58afd3bad971626908","placeholder":"​","style":"IPY_MODEL_96cf3aea9af34f5897d477a3b689d828","value":" 63114/63114 [00:22&lt;00:00, 3088.32ex/s]"}},"3b888c2a16c3492e91710bcca381c211":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"db4a2992342540059f2f82f8bc154873":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"916685ec38bc4c4490e462d25710ad2d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"05146061c9494df2bd747c5af73aeb08":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f9266defd60b4d24a685654b5aac98a8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"fef9c0daa7494a58afd3bad971626908":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"96cf3aea9af34f5897d477a3b689d828":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"519e0ec26ec741eb9c1b4b34e37d1c31":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_c7a79a5ffc3c4f5dbc4e5efce4962f7a","IPY_MODEL_3777a646a57149b8be54acc7e79d02ad","IPY_MODEL_5a1cb21ca7a14234b244180329383141"],"layout":"IPY_MODEL_bd79a0de9f0b4da9bcd3b5195b077f44"}},"c7a79a5ffc3c4f5dbc4e5efce4962f7a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9c1fd64da60044cbbd460e6fa865e7c4","placeholder":"​","style":"IPY_MODEL_afef2b26f6f943d0a0d96cd71ca49239","value":"100%"}},"3777a646a57149b8be54acc7e79d02ad":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c8f06b4f72174fd2855c3f9f944b317c","max":15779,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a45470ee87654d58a9d715db67a5fe01","value":15779}},"5a1cb21ca7a14234b244180329383141":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b5812fdd120c44c8ac30c949a1c63470","placeholder":"​","style":"IPY_MODEL_d439e4b0bb894e1188a6c422c0584db8","value":" 15779/15779 [00:05&lt;00:00, 3029.23ex/s]"}},"bd79a0de9f0b4da9bcd3b5195b077f44":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9c1fd64da60044cbbd460e6fa865e7c4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"afef2b26f6f943d0a0d96cd71ca49239":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c8f06b4f72174fd2855c3f9f944b317c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a45470ee87654d58a9d715db67a5fe01":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b5812fdd120c44c8ac30c949a1c63470":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d439e4b0bb894e1188a6c422c0584db8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# Import Packages"],"metadata":{"id":"SGpeoDBeWgJF"}},{"cell_type":"code","source":["# reference: https://lajavaness.medium.com/regression-with-text-input-using-bert-and-transformers-71c155034b13\n","%%time\n","from google.colab import drive\n","drive.mount('/content/drive')\n","!pip install transformers\n","!pip install datasets --upgrade\n","!pip install accelerate\n","import pandas as pd\n","from datasets import Dataset\n","from sklearn.model_selection import train_test_split\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification, DataCollatorWithPadding\n","from torch.utils.data import DataLoader\n","from sklearn.metrics import mean_absolute_error\n","from sklearn.metrics import mean_squared_error\n","from sklearn.metrics import r2_score\n","from transformers import TrainingArguments, Trainer\n","import math\n","import torch"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"x3OyeOeGH1C4","executionInfo":{"status":"ok","timestamp":1652247249384,"user_tz":420,"elapsed":45741,"user":{"displayName":"Woody","userId":"03933623217336835621"}},"outputId":"6d531c37-5388-4ae2-b706-3f745f08bd13"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n","Collecting transformers\n","  Downloading transformers-4.18.0-py3-none-any.whl (4.0 MB)\n","\u001b[K     |████████████████████████████████| 4.0 MB 32.1 MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Collecting sacremoses\n","  Downloading sacremoses-0.0.53.tar.gz (880 kB)\n","\u001b[K     |████████████████████████████████| 880 kB 82.6 MB/s \n","\u001b[?25hCollecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 80.4 MB/s \n","\u001b[?25hCollecting huggingface-hub<1.0,>=0.1.0\n","  Downloading huggingface_hub-0.5.1-py3-none-any.whl (77 kB)\n","\u001b[K     |████████████████████████████████| 77 kB 9.5 MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.6.0)\n","Collecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.12.1-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.6 MB)\n","\u001b[K     |████████████████████████████████| 6.6 MB 72.8 MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.0)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.11.3)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (4.2.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.8)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.0)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2021.10.8)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.1.0)\n","Building wheels for collected packages: sacremoses\n","  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sacremoses: filename=sacremoses-0.0.53-py3-none-any.whl size=895260 sha256=008933f1e74ba844f3f8c5201a8769485ba5d357034b338d52659f9ca7a47eef\n","  Stored in directory: /root/.cache/pip/wheels/87/39/dd/a83eeef36d0bf98e7a4d1933a4ad2d660295a40613079bafc9\n","Successfully built sacremoses\n","Installing collected packages: pyyaml, tokenizers, sacremoses, huggingface-hub, transformers\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed huggingface-hub-0.5.1 pyyaml-6.0 sacremoses-0.0.53 tokenizers-0.12.1 transformers-4.18.0\n","Collecting datasets\n","  Downloading datasets-2.2.0-py3-none-any.whl (342 kB)\n","\u001b[K     |████████████████████████████████| 342 kB 39.6 MB/s \n","\u001b[?25hRequirement already satisfied: multiprocess in /usr/local/lib/python3.7/dist-packages (from datasets) (0.70.12.2)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (2.23.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from datasets) (1.21.6)\n","Requirement already satisfied: huggingface-hub<1.0.0,>=0.1.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (0.5.1)\n","Collecting aiohttp\n","  Downloading aiohttp-3.8.1-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.1 MB)\n","\u001b[K     |████████████████████████████████| 1.1 MB 72.5 MB/s \n","\u001b[?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from datasets) (4.11.3)\n","Requirement already satisfied: pyarrow>=6.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (6.0.1)\n","Collecting xxhash\n","  Downloading xxhash-3.0.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[K     |████████████████████████████████| 212 kB 78.1 MB/s \n","\u001b[?25hCollecting responses<0.19\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Collecting fsspec[http]>=2021.05.0\n","  Downloading fsspec-2022.3.0-py3-none-any.whl (136 kB)\n","\u001b[K     |████████████████████████████████| 136 kB 90.1 MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.7/dist-packages (from datasets) (4.64.0)\n","Requirement already satisfied: dill in /usr/local/lib/python3.7/dist-packages (from datasets) (0.3.4)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from datasets) (21.3)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from datasets) (1.3.5)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (3.6.0)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (4.2.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->datasets) (3.0.8)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2021.10.8)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (3.0.4)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2.10)\n","Collecting urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1\n","  Downloading urllib3-1.25.11-py2.py3-none-any.whl (127 kB)\n","\u001b[K     |████████████████████████████████| 127 kB 92.2 MB/s \n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3\n","  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\n","Collecting asynctest==0.13.0\n","  Downloading asynctest-0.13.0-py3-none-any.whl (26 kB)\n","Requirement already satisfied: charset-normalizer<3.0,>=2.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (2.0.12)\n","Collecting yarl<2.0,>=1.0\n","  Downloading yarl-1.7.2-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (271 kB)\n","\u001b[K     |████████████████████████████████| 271 kB 71.2 MB/s \n","\u001b[?25hCollecting frozenlist>=1.1.1\n","  Downloading frozenlist-1.3.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (144 kB)\n","\u001b[K     |████████████████████████████████| 144 kB 98.7 MB/s \n","\u001b[?25hRequirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (21.4.0)\n","Collecting multidict<7.0,>=4.5\n","  Downloading multidict-6.0.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (94 kB)\n","\u001b[K     |████████████████████████████████| 94 kB 5.1 MB/s \n","\u001b[?25hCollecting aiosignal>=1.1.2\n","  Downloading aiosignal-1.2.0-py3-none-any.whl (8.2 kB)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->datasets) (3.8.0)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2022.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil>=2.7.3->pandas->datasets) (1.15.0)\n","Installing collected packages: multidict, frozenlist, yarl, urllib3, asynctest, async-timeout, aiosignal, fsspec, aiohttp, xxhash, responses, datasets\n","  Attempting uninstall: urllib3\n","    Found existing installation: urllib3 1.24.3\n","    Uninstalling urllib3-1.24.3:\n","      Successfully uninstalled urllib3-1.24.3\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","datascience 0.10.6 requires folium==0.2.1, but you have folium 0.8.3 which is incompatible.\u001b[0m\n","Successfully installed aiohttp-3.8.1 aiosignal-1.2.0 async-timeout-4.0.2 asynctest-0.13.0 datasets-2.2.0 frozenlist-1.3.0 fsspec-2022.3.0 multidict-6.0.2 responses-0.18.0 urllib3-1.25.11 xxhash-3.0.0 yarl-1.7.2\n","Collecting accelerate\n","  Downloading accelerate-0.7.1-py3-none-any.whl (79 kB)\n","\u001b[K     |████████████████████████████████| 79 kB 8.6 MB/s \n","\u001b[?25hRequirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from accelerate) (6.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from accelerate) (1.21.6)\n","Requirement already satisfied: torch>=1.4.0 in /usr/local/lib/python3.7/dist-packages (from accelerate) (1.11.0+cu113)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch>=1.4.0->accelerate) (4.2.0)\n","Installing collected packages: accelerate\n","Successfully installed accelerate-0.7.1\n","CPU times: user 4.34 s, sys: 976 ms, total: 5.32 s\n","Wall time: 46.1 s\n"]}]},{"cell_type":"markdown","source":["# Prepare Datasets"],"metadata":{"id":"WVb0GmyuWc1s"}},{"cell_type":"code","source":["# read the dataset\n","path = '/content/drive/MyDrive/DSO 560 NLP Team Project/'\n","df_1 = pd.read_csv(f'{path}clean_data/bumble_hinge_review.csv')\n","df = df_1[df_1['App']=='Bumble'].copy()\n","df.dropna(inplace=True)\n","df.reset_index(inplace=True)\n","df.rename(columns={'Review':'text','App':'app','Rating':'score','index':'id'},inplace=True)\n","df = df[['id','text','score','app']]"],"metadata":{"id":"gHnjpix6ZXW4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# split into train and test data\n","train_df, test_df = train_test_split(df, test_size=0.2, random_state=2, stratify=df['score'])\n","raw_train_ds = Dataset.from_pandas(train_df, preserve_index=False)\n","raw_val_ds = Dataset.from_pandas(test_df, preserve_index=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"95pwnj6VUMfh","executionInfo":{"status":"ok","timestamp":1652247252562,"user_tz":420,"elapsed":6,"user":{"displayName":"Woody","userId":"03933623217336835621"}},"outputId":"c528190f-6dde-4931-fc0f-68d04314d23d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'app': 'Bumble',\n"," 'id': 37695,\n"," 'score': 2,\n"," 'text': 'the algorithm and ui be complete trash ! nowhere to see how many coin you have leave . you get bury and bury the more you . load of robot and instagram clout chaser . oh , and if you swipe right on those you get even more buried . need a rehaul .'}"]},"metadata":{},"execution_count":3}]},{"cell_type":"markdown","source":["# Set Up Model"],"metadata":{"id":"AW5FIEJtVp4s"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"tLyb3IEj0_sF","executionInfo":{"status":"ok","timestamp":1652247273128,"user_tz":420,"elapsed":20569,"user":{"displayName":"Woody","userId":"03933623217336835621"}},"colab":{"base_uri":"https://localhost:8080/","height":288,"referenced_widgets":["c73689dabc154460b62ca969bd966356","355b8fc89a694b4594cb083c8d5da728","669496d664864517a8d54cce73d66ae9","04eb7850d1dd40a089d61206c2376809","a2189a76c0694812a3ad5eaa8878a041","448a122015a34b46a65888ce295f3680","7e4fca1b2be545309f25e3d987ac0f14","156d8cd6f3e64b22be5a465d976baaba","06392519b2b3454785f929b20b1e09e4","8cf4e93a74e842bda7ad2caac32dea08","4310e9468fd64f3ab10ba47fcac6e896","650d91dd4ddc41988dabbca35e023d69","dabef8c995304c0abcbdf4c8140285a6","839399320a9f46a1b3c3d2a6af29ad4e","b4b4d6a602234da0845ff348c55abb85","671e7155eb00400ab1dd5bdfdbcb7e7e","1e0bfebfd62340fdb7bd8941e3db62b1","1d427807d5544e91a1bd8b0dd59f12f7","f07cba2886e9425c9c5b216cf0d2852e","baa47ec25b054f68b0a6c4e02f9dd944","62b1ae2f8c2f4209be0793f4de4d917f","75f5a6e9ea4748f38b6d38103644e6b5","b08e48ffeeb24352be218a5c9a577c12","126d66791d1a474299a1967bda8975cb","33507e5d29fe4ec1abedef2656250c75","772802b78a2e4516a07c2ba676aea659","a00562d156be49bebe5b2c0875274968","95566268cb67462494efdae87d1749c5","eb9c36ebdc5e4464be3bd5b264e621b8","6321c11e348c4ed48c82f32d1fbe81ad","6991293b7d974856895d3b8e58e381e7","2dc6d2855ec248ba82fa590633698a21","2a08cc18b90c41868003bb972528c16c","bd3f720d0c094206a33eaa23d072c22a","dbbcaf896c7c47518904a781ba110231","1104e88d72c94205ad934ee19beb1983","c905516344274078b3125d24731e3ff5","18693f11ec414fa1801966eb74ea01aa","0df20fa207b04b6fb6cb9e7c37b5b761","05037e8a3c2b44c39a74b4a0c47b784b","50c4340771f844419f7abe2f3f4e1409","ea7f722d532a48da98f3ad46e646130c","208068876df840f38271cf702a82483a","5afa9b1632794dc99241a1efc1282bc1","5895e371bc374e56ac9387aa6d77c4fc","ff0e9c9692414dccb61693e3b37dbc2c","31f7c023f7844813a3d312f80ae8a654","e5d33f8d5b624b6c974cd47c24e861e6","2927a394a46c42998cb3646d4414f336","6f013c0fe5ac4eb4b248f7660ac285a3","9832bc9fd7d744d48b2d3059a3fa6750","efa0f16b89d44abca8441c21edd3f7e2","ba13f81bb0e644a8bb660f56e74b0c07","b75b6b4eeead41caaaa87e8c7146034e","c795c44d63774ce68f0a80cf48814226"]},"outputId":"0db5ce15-cdb4-4193-d377-07e9f579945f"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/28.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c73689dabc154460b62ca969bd966356"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/483 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"650d91dd4ddc41988dabbca35e023d69"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/226k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b08e48ffeeb24352be218a5c9a577c12"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/455k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"bd3f720d0c094206a33eaa23d072c22a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/256M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5895e371bc374e56ac9387aa6d77c4fc"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at distilbert-base-uncased were not used when initializing DistilBertForSequenceClassification: ['vocab_layer_norm.bias', 'vocab_transform.bias', 'vocab_projector.weight', 'vocab_layer_norm.weight', 'vocab_projector.bias', 'vocab_transform.weight']\n","- This IS expected if you are initializing DistilBertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing DistilBertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-uncased and are newly initialized: ['pre_classifier.weight', 'classifier.weight', 'classifier.bias', 'pre_classifier.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}],"source":["# download models and set parameters\n","BASE_MODEL = \"distilbert-base-uncased\"\n","LEARNING_RATE = 2e-5\n","MAX_LENGTH = 256\n","BATCH_SIZE = 32\n","EPOCHS = 6\n","\n","tokenizer = AutoTokenizer.from_pretrained(BASE_MODEL)\n","model = AutoModelForSequenceClassification.from_pretrained(BASE_MODEL, num_labels=1)"]},{"cell_type":"markdown","source":["# Preprocessing"],"metadata":{"id":"1h1K_j29VthP"}},{"cell_type":"code","source":["# make data readable by models\n","ds = {\"train\": raw_train_ds, \"validation\": raw_val_ds}\n","\n","def preprocess_function(examples):\n","    label = examples[\"score\"] \n","    examples = tokenizer(examples[\"text\"], truncation=True, padding=\"max_length\", max_length=256)\n","    \n","    # Change this to real number\n","    examples[\"label\"] = float(label)\n","    return examples\n","\n","for split in ds:\n","    ds[split] = ds[split].map(preprocess_function, remove_columns=[\"id\", \"score\", \"text\", \"app\"])"],"metadata":{"id":"33LcxTnAikGm","executionInfo":{"status":"ok","timestamp":1652247301030,"user_tz":420,"elapsed":27912,"user":{"displayName":"Woody","userId":"03933623217336835621"}},"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["40b9babba79e4775a7bfbc85a8f8feca","f851b46ca63149a2a8ce9d9c843b89ac","f63a283e753c4ec1a44e7a225387caea","3dc05ceb1b2749a886bb6c54821ceaf2","3b888c2a16c3492e91710bcca381c211","db4a2992342540059f2f82f8bc154873","916685ec38bc4c4490e462d25710ad2d","05146061c9494df2bd747c5af73aeb08","f9266defd60b4d24a685654b5aac98a8","fef9c0daa7494a58afd3bad971626908","96cf3aea9af34f5897d477a3b689d828","519e0ec26ec741eb9c1b4b34e37d1c31","c7a79a5ffc3c4f5dbc4e5efce4962f7a","3777a646a57149b8be54acc7e79d02ad","5a1cb21ca7a14234b244180329383141","bd79a0de9f0b4da9bcd3b5195b077f44","9c1fd64da60044cbbd460e6fa865e7c4","afef2b26f6f943d0a0d96cd71ca49239","c8f06b4f72174fd2855c3f9f944b317c","a45470ee87654d58a9d715db67a5fe01","b5812fdd120c44c8ac30c949a1c63470","d439e4b0bb894e1188a6c422c0584db8"]},"outputId":"f85f1c78-aca1-4706-cb4e-f60ffce612ec"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/63114 [00:00<?, ?ex/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"40b9babba79e4775a7bfbc85a8f8feca"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/15779 [00:00<?, ?ex/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"519e0ec26ec741eb9c1b4b34e37d1c31"}},"metadata":{}}]},{"cell_type":"markdown","source":["# Metrics"],"metadata":{"id":"ZVco3UWfV1UT"}},{"cell_type":"code","source":["# define mse, mae, r2, accuracy as the evaluation metrics\n","def compute_metrics_for_regression(eval_pred):\n","    logits, labels = eval_pred\n","    labels = labels.reshape(-1, 1)\n","    \n","    mse = mean_squared_error(labels, logits)\n","    mae = mean_absolute_error(labels, logits)\n","    r2 = r2_score(labels, logits)\n","    single_squared_errors = ((logits - labels).flatten()**2).tolist()\n","    \n","    # Compute accuracy \n","    # Based on the fact that the rounded score = true score only if |single_squared_errors| < 0.5\n","    accuracy = sum([1 for e in single_squared_errors if e < 0.25]) / len(single_squared_errors)\n","    \n","    return {\"mse\": mse, \"mae\": mae, \"r2\": r2, \"accuracy\": accuracy}"],"metadata":{"id":"2xb2rX2AV0YS"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Loss Function"],"metadata":{"id":"4A0UXK6nWBcn"}},{"cell_type":"code","source":["# define loss function\n","class RegressionTrainer(Trainer):\n","    def compute_loss(self, model, inputs, return_outputs=False):\n","        labels = inputs.pop(\"labels\")\n","        outputs = model(**inputs)\n","        logits = outputs[0][:, 0]\n","        loss = torch.nn.functional.mse_loss(logits, labels)\n","        return (loss, outputs) if return_outputs else loss"],"metadata":{"id":"c9mC1G2mWAsm"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Training"],"metadata":{"id":"Iqbli6SWWIBr"}},{"cell_type":"code","source":["# define training arguments\n","training_args = TrainingArguments(\n","    output_dir=f\"{path}/rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510\",\n","    learning_rate=LEARNING_RATE,\n","    per_device_train_batch_size=BATCH_SIZE,\n","    per_device_eval_batch_size=BATCH_SIZE,\n","    num_train_epochs=EPOCHS,\n","    evaluation_strategy=\"epoch\",\n","    save_strategy=\"epoch\",\n","    save_total_limit=2,\n","    metric_for_best_model=\"accuracy\",\n","    load_best_model_at_end=True,\n","    weight_decay=0.01,\n",")"],"metadata":{"id":"LG6Zqgdq-TRz"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# start training\n","trainer = RegressionTrainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=ds[\"train\"],\n","    eval_dataset=ds[\"validation\"],\n","    compute_metrics=compute_metrics_for_regression,\n",")\n","\n","trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"vcjadrvVWF7v","outputId":"c99be0ef-cf14-4003-a9bc-afaf821c691c","executionInfo":{"status":"ok","timestamp":1652255739131,"user_tz":420,"elapsed":8437683,"user":{"displayName":"Woody","userId":"03933623217336835621"}}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/optimization.py:309: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  FutureWarning,\n","***** Running training *****\n","  Num examples = 63114\n","  Num Epochs = 6\n","  Instantaneous batch size per device = 32\n","  Total train batch size (w. parallel, distributed & accumulation) = 32\n","  Gradient Accumulation steps = 1\n","  Total optimization steps = 11838\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='11838' max='11838' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [11838/11838 2:20:24, Epoch 6/6]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Mse</th>\n","      <th>Mae</th>\n","      <th>R2</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>1</td>\n","      <td>0.753900</td>\n","      <td>0.709951</td>\n","      <td>0.709951</td>\n","      <td>0.544621</td>\n","      <td>0.731876</td>\n","      <td>0.628557</td>\n","    </tr>\n","    <tr>\n","      <td>2</td>\n","      <td>0.613500</td>\n","      <td>0.670616</td>\n","      <td>0.670616</td>\n","      <td>0.564576</td>\n","      <td>0.746731</td>\n","      <td>0.604601</td>\n","    </tr>\n","    <tr>\n","      <td>3</td>\n","      <td>0.449300</td>\n","      <td>0.697405</td>\n","      <td>0.697405</td>\n","      <td>0.552701</td>\n","      <td>0.736614</td>\n","      <td>0.617847</td>\n","    </tr>\n","    <tr>\n","      <td>4</td>\n","      <td>0.373400</td>\n","      <td>0.688299</td>\n","      <td>0.688299</td>\n","      <td>0.532476</td>\n","      <td>0.740053</td>\n","      <td>0.636986</td>\n","    </tr>\n","    <tr>\n","      <td>5</td>\n","      <td>0.330800</td>\n","      <td>0.736329</td>\n","      <td>0.736329</td>\n","      <td>0.544928</td>\n","      <td>0.721914</td>\n","      <td>0.633944</td>\n","    </tr>\n","    <tr>\n","      <td>6</td>\n","      <td>0.285900</td>\n","      <td>0.716081</td>\n","      <td>0.716081</td>\n","      <td>0.530201</td>\n","      <td>0.729560</td>\n","      <td>0.645478</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["***** Running Evaluation *****\n","  Num examples = 15779\n","  Batch size = 32\n","Saving model checkpoint to /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-1973\n","Configuration saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-1973/config.json\n","Model weights saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-1973/pytorch_model.bin\n","***** Running Evaluation *****\n","  Num examples = 15779\n","  Batch size = 32\n","Saving model checkpoint to /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-3946\n","Configuration saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-3946/config.json\n","Model weights saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-3946/pytorch_model.bin\n","***** Running Evaluation *****\n","  Num examples = 15779\n","  Batch size = 32\n","Saving model checkpoint to /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-5919\n","Configuration saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-5919/config.json\n","Model weights saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-5919/pytorch_model.bin\n","Deleting older checkpoint [/content/drive/MyDrive/DSO 560 NLP Team Project/rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-3946] due to args.save_total_limit\n","***** Running Evaluation *****\n","  Num examples = 15779\n","  Batch size = 32\n","Saving model checkpoint to /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-7892\n","Configuration saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-7892/config.json\n","Model weights saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-7892/pytorch_model.bin\n","Deleting older checkpoint [/content/drive/MyDrive/DSO 560 NLP Team Project/rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-1973] due to args.save_total_limit\n","***** Running Evaluation *****\n","  Num examples = 15779\n","  Batch size = 32\n","Saving model checkpoint to /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-9865\n","Configuration saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-9865/config.json\n","Model weights saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-9865/pytorch_model.bin\n","Deleting older checkpoint [/content/drive/MyDrive/DSO 560 NLP Team Project/rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-5919] due to args.save_total_limit\n","***** Running Evaluation *****\n","  Num examples = 15779\n","  Batch size = 32\n","Saving model checkpoint to /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-11838\n","Configuration saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-11838/config.json\n","Model weights saved in /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-11838/pytorch_model.bin\n","Deleting older checkpoint [/content/drive/MyDrive/DSO 560 NLP Team Project/rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-7892] due to args.save_total_limit\n","\n","\n","Training completed. Do not forget to share your model on huggingface.co/models =)\n","\n","\n","Loading best model from /content/drive/MyDrive/DSO 560 NLP Team Project//rating prediction/model/distilbert-fine-tuned-regression-on-bumble-0510/checkpoint-11838 (score: 0.6454781671842322).\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=11838, training_loss=0.48866202561793687, metrics={'train_runtime': 8425.2846, 'train_samples_per_second': 44.946, 'train_steps_per_second': 1.405, 'total_flos': 2.5081194900842496e+16, 'train_loss': 0.48866202561793687, 'epoch': 6.0})"]},"metadata":{},"execution_count":10}]},{"cell_type":"markdown","source":["# Evaluation on Test Set"],"metadata":{"id":"Rc3_iQPOWLuM"}},{"cell_type":"code","source":["# model performace evaluation\n","trainer.eval_dataset=ds[\"validation\"]\n","trainer.evaluate()"],"metadata":{"id":"TCgnr0TcWK3e","colab":{"base_uri":"https://localhost:8080/","height":256},"executionInfo":{"status":"ok","timestamp":1652255860117,"user_tz":420,"elapsed":120989,"user":{"displayName":"Woody","userId":"03933623217336835621"}},"outputId":"a3049c81-2e49-4a45-97c6-feba35331178"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["***** Running Evaluation *****\n","  Num examples = 15779\n","  Batch size = 32\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='494' max='494' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [494/494 02:00]\n","    </div>\n","    "]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["{'epoch': 6.0,\n"," 'eval_accuracy': 0.6454781671842322,\n"," 'eval_loss': 0.7160808444023132,\n"," 'eval_mae': 0.5302008390426636,\n"," 'eval_mse': 0.7160808444023132,\n"," 'eval_r2': 0.7295604350319009,\n"," 'eval_runtime': 120.7193,\n"," 'eval_samples_per_second': 130.708,\n"," 'eval_steps_per_second': 4.092}"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["# look at discrepancies of predicted rating and original rating\n","nb_batches = math.ceil(len(raw_val_ds)/BATCH_SIZE)\n","y_preds = []\n","\n","for i in range(nb_batches):\n","    input_texts = raw_val_ds[i * BATCH_SIZE: (i+1) * BATCH_SIZE][\"text\"]\n","    input_labels = raw_val_ds[i * BATCH_SIZE: (i+1) * BATCH_SIZE][\"score\"]\n","    encoded = tokenizer(input_texts, truncation=True, padding=\"max_length\", max_length=256, return_tensors=\"pt\").to(\"cuda\")\n","    y_preds += model(**encoded).logits.reshape(-1).tolist()\n","\n","pd.set_option('display.max_rows', 500)\n","df = pd.DataFrame([raw_val_ds[\"text\"], raw_val_ds[\"score\"], y_preds], [\"Text\", \"Score\", \"Prediction\"]).T\n","df[\"Rounded Prediction\"] = df[\"Prediction\"].apply(round)\n","incorrect_cases = df[df[\"Score\"] != df[\"Rounded Prediction\"]]\n","incorrect_cases"],"metadata":{"id":"0754h5-c4zD8","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1652255980620,"user_tz":420,"elapsed":120510,"user":{"displayName":"Woody","userId":"03933623217336835621"}},"outputId":"3c549e54-38df-4ecd-dab1-9434728fcaba"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                    Text Score Prediction  \\\n","8      be work but now all of the sudden it wont let ...     1   2.297964   \n","9      for some reason it just kick me off my account...     3   1.414213   \n","10     i love it , take the pressure of send that fir...     5   4.419391   \n","11     love the app and interface so far though i not...     3   4.128532   \n","12            good experience but wayyyyyy too expensive     1   4.520153   \n","...                                                  ...   ...        ...   \n","15761             good concept but i be not very popular     3   3.686997   \n","15765  meet real female . in less than 3 day . talk o...     4   2.130829   \n","15770                           this be the bad app ever     5   1.058453   \n","15776  have not meet anyone on here because this site...     1   2.214409   \n","15778  i really love how both ppl have to `` swipe ri...     4   4.548282   \n","\n","       Rounded Prediction  \n","8                       2  \n","9                       1  \n","10                      4  \n","11                      4  \n","12                      5  \n","...                   ...  \n","15761                   4  \n","15765                   2  \n","15770                   1  \n","15776                   2  \n","15778                   5  \n","\n","[5594 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-61991272-54db-4bd8-ac58-8562d35ab0ce\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Text</th>\n","      <th>Score</th>\n","      <th>Prediction</th>\n","      <th>Rounded Prediction</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>8</th>\n","      <td>be work but now all of the sudden it wont let ...</td>\n","      <td>1</td>\n","      <td>2.297964</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>for some reason it just kick me off my account...</td>\n","      <td>3</td>\n","      <td>1.414213</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>i love it , take the pressure of send that fir...</td>\n","      <td>5</td>\n","      <td>4.419391</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>love the app and interface so far though i not...</td>\n","      <td>3</td>\n","      <td>4.128532</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>good experience but wayyyyyy too expensive</td>\n","      <td>1</td>\n","      <td>4.520153</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>15761</th>\n","      <td>good concept but i be not very popular</td>\n","      <td>3</td>\n","      <td>3.686997</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>15765</th>\n","      <td>meet real female . in less than 3 day . talk o...</td>\n","      <td>4</td>\n","      <td>2.130829</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>15770</th>\n","      <td>this be the bad app ever</td>\n","      <td>5</td>\n","      <td>1.058453</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>15776</th>\n","      <td>have not meet anyone on here because this site...</td>\n","      <td>1</td>\n","      <td>2.214409</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>15778</th>\n","      <td>i really love how both ppl have to `` swipe ri...</td>\n","      <td>4</td>\n","      <td>4.548282</td>\n","      <td>5</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5594 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-61991272-54db-4bd8-ac58-8562d35ab0ce')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-61991272-54db-4bd8-ac58-8562d35ab0ce button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-61991272-54db-4bd8-ac58-8562d35ab0ce');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":13}]}]}